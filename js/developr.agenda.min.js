(function(c,u){c.fn.scrollAgenda=function(b){var m=c.extend({},c.fn.scrollAgenda.defaults,b);this.each(function(){var b=c(this).closest(".agenda").addClass("scrolling-agenda"),e=c.extend({},m,b.data("agenda-options")),f=b.children(".agenda-wrapper").children(".agenda-events"),t=f.length,k,g=-1,h=[-1,-1],p,j,q,r;1>t||(f.children(".agenda-header").each(function(a){var b=c(this);0<a&&0===b.children(".agenda-previous").length&&c('<a href="#" title="'+e.prevTitle+'" class="agenda-previous"><span class="icon-left-round"></span></a>').prependTo(b).applySetup();
a<t-1&&0===b.children(".agenda-next").length&&c('<a href="#" title="'+e.nextTitle+'" class="agenda-next"><span class="icon-right-round"></span></a>').prependTo(b).applySetup()}),b.on("click",".agenda-previous",function(a){a.preventDefault();q()}).on("click",".agenda-next",function(a){a.preventDefault();r()}),f.eq(e.first).addClass("agenda-visible-column"),p=function(){var a,c=g;g=e.auto?Math.max(1,Math.floor(b.width()/e.minWidth)):e.columns;k=100/g;a=f.filter(".agenda-visible-column:first");0===a.length?
a=f.eq(0):a.nextAll(".agenda-events").length<g-1&&(a=f.eq(-g));g!==c&&e.onSizeChange&&e.onSizeChange.call(b[0],g);j(a,!1)},j=function(a,l){var m=h[0],j=h[1],n;"number"===typeof a?a=f.eq(a):"string"===typeof a&&(a=f.filter(a));if(l===u||null===l)l=e.animate;a instanceof jQuery&&0!==a.length&&(a=a.first(),a.data("agenda-fixed-left",!1).data("agenda-fixed-right",!1).data("agenda-initial-left",a[0].style.left?parseFloat(a[0].style.left):!1).data("agenda-initial-right",a[0].style.right?parseFloat(a[0].style.right):
!1),a.addClass("agenda-visible-column agenda-visible-first").stop(!0)[l?"animate":"css"]({left:"0%",right:100-k+"%",marginLeft:"-1px"},{step:function(b,d){var c;if(("left"===d.prop||"right"===d.prop)&&!a.data("agenda-fixed-"+d.prop)){if(c=a.data("agenda-initial-"+d.prop))console.log("init",d.prop,c),d.now=c+(b-d.start)/(d.end-d.start)*(d.end-c),a.css(d.prop,d.now),d.start=c;a.data("agenda-fixed-"+d.prop,!0)}console.log(d.prop,b)}}),a[1===g?"addClass":"removeClass"]("agenda-visible-last"),n=a.prevAll(".agenda-events"),
n.removeClass("agenda-visible-column agenda-visible-first agenda-visible-last").each(function(a){var d=c(this);d.data("agenda-fixed-left",!1).data("agenda-fixed-right",!1).data("agenda-initial-left",d[0].style.left?parseFloat(d[0].style.left):!1).data("agenda-initial-right",d[0].style.right?parseFloat(d[0].style.right):!1);d.stop(!0)[l?"animate":"css"]({left:-k*(a+1)+"%",right:100+k*a+"%",marginLeft:"0px"},{step:function(a,b){var c;if(("left"===b.prop||"right"===b.prop)&&!d.data("agenda-fixed-"+b.prop)){if(c=
d.data("agenda-initial-"+b.prop))b.now=c+(a-b.start)/(b.end-b.start)*(b.end-c),d.css(b.prop,b.now),b.start=c;d.data("agenda-fixed-"+b.prop,!0)}}})}),a.nextAll(".agenda-events").removeClass("agenda-visible-first").each(function(a){var b=c(this);b.data("agenda-fixed-left",!1).data("agenda-fixed-right",!1).data("agenda-initial-left",b[0].style.left?parseFloat(b[0].style.left):!1).data("agenda-initial-right",b[0].style.right?parseFloat(b[0].style.right):!1);b[a<g-1?"addClass":"removeClass"]("agenda-visible-column");
b[a===g-2?"addClass":"removeClass"]("agenda-visible-last");b.stop(!0)[l?"animate":"css"]({left:k*(a+1)+"%",right:100-k*(a+2)+"%",marginLeft:"0px"},{step:function(a,c){var e;if(("left"===c.prop||"right"===c.prop)&&!b.data("agenda-fixed-"+c.prop)){if(e=b.data("agenda-initial-"+c.prop))c.now=e+(a-c.start)/(c.end-c.start)*(c.end-e),b.css(c.prop,c.now),c.start=e;b.data("agenda-fixed-"+c.prop,!0)}}})}),h=[n.length,n.length+g-1],(m!=h[0]||j!=h[1])&&e.onRangeChange&&e.onRangeChange.call(b[0],h[0],h[1]))},
p(),b.widthchange(p),q=function(){var a;a=f.filter(".agenda-visible-column:first");0===a.length&&(a=f.eq(0));a=a.prev(".agenda-events");return 0<a.length?(j(a,e.animate),!0):!1},r=function(){var a;a=f.filter(".agenda-visible-column:first");0===a.length&&(a=f.eq(0));a=a.nextAll(".agenda-events");return a.length>=g?(j(a.first(),e.animate),!0):!1},b.data("agenda",{setFirstColumn:j,scrollPrevious:q,scrollNext:r}))});return this};c.fn.scrollAgendaFirstColumn=function(b,m){return this.each(function(){var s=
c(this).closest(".agenda").data("agenda");s&&s.setFirstColumn(b,m)})};c.fn.scrollAgendaToPrevious=function(){return this.each(function(){var b=c(this).closest(".agenda").data("agenda");b&&b.scrollPrevious()})};c.fn.scrollAgendaToNext=function(){return this.each(function(){var b=c(this).closest(".agenda").data("agenda");b&&b.scrollNext()})};c.fn.scrollAgenda.defaults={auto:!0,columns:1,minWidth:200,animate:!0,first:0,prevTitle:"Previous",nextTitle:"Next",onSizeChange:null,onRangeChange:null};c.template.addSetupFunction(function(b,
c){this.findIn(b,c,".auto-scroll").scrollAgenda();return this})})(jQuery);